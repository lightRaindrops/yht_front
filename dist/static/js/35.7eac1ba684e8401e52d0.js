webpackJsonp([35],{HvOy:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("mvHQ"),o=l.n(a),n={data:function(){return{showDialog:!1,tableLoading:!0,showPulishDialog:!1,pageSize:5,pageNow:1,query:{date:"",isPublic:0,received:0,user:0,offset:0,limit:5},form:{id:"",name:"",phone:"",demand:"",brand_id:"",wechat:"",qq:"",province:"",city:"",area:"",project_name:"",description:""},rules:{name:[{required:!0,message:"请输入称呼",trigger:"blur"},{min:1,message:"称呼不少于两个字",trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{validator:function(e,t,l){0==/^1[34578]\d{9}$/.test(t)&&0==/^\d{3,4}\-\d{7,}/.test(t)?l(new Error("请输入正确的联系方式")):l()},trigger:"blur"}]},props:{value:"id"},selectedOptions:[20,234,2331],isPublicOptions:[{value:0,label:"全部"},{value:1,label:"已发布"},{value:2,label:"未发布"}],receivedOptions:[{value:0,label:"全部"},{value:1,label:"已验收"},{value:2,label:"未验收"}],users:[{value:0,label:"全部"}],tableColumn:{id:!0,name:!0,phone:!0,wechat:!1,qq:!1,brand_name:!0,province:!0,project_name:!1,description:!1,publish:!0,user:!0,accept:!1,created:!0,accept_date:!1,receive_date:!1},searching:!1,pageSizes:[5,10,20,50,100],publishOptions:[{value:0,label:"公开"},{value:1,label:"部门可见"}],publish:{id:0,name:"",type:0},update:!1}},methods:{openDialog:function(){this.showDialog=!0,this.update=!1},onSubmit:function(e){var t=this;this.$refs[e].validate(function(l){if(l){var a="customerCreate";t.update&&(a="customerUpdate"),t.$store.dispatch(a,t.form).then(function(){"success"==t.$store.state.user.customerCreate.status?(t.$notify.success({title:"操作成功",message:"操作成功"}),t.showDialog=!1,t.update=!1,t.resetForm(e),t.initTable(t.query)):t.$notify.error({title:"操作失败",message:t.$store.state.user.customerCreate.errmsg})})}})},resetForm:function(e){for(var t in this.$refs[e].resetFields(),this[e])this[e][t]=""},DialogClose:function(){this.update=!1,this.form.id="",this.resetForm("form")},upload:function(){},handleItemChange:function(e){e[0]},handleChange:function(e){this.regionValue(e),this.loadCascader(e[0])},handleBlur:function(e){},regionValue:function(e){this.form.province=e[0],this.form.city=e[1],this.form.area=e[2]},loadCascader:function(e){return this.$store.dispatch("getRegion",{id:e})},onSearch:function(){this.searching=!0},initTable:function(e){var t=this;this.tableLoading=!0,this.$store.dispatch("customerManagerList",e).then(function(){t.tableLoading=!1})},handleSizeChange:function(e){this.query.limit=e,this.initTable(this.query)},handleCurrentChange:function(e){this.query.offset=(e-1)*this.query.limit,this.initTable(this.query)},handleEdit:function(e){var t=this,l=JSON.parse(o()(e));for(var a in l.province=l.province.id,l.city=l.city.id,l.area=l.area.id,this.form)this.form[a]=l[a];this.loadCascader(this.form.province).then(function(){t.selectedOptions=[t.form.province,t.form.city,t.form.area]}),this.update=!0,this.showDialog=!0},handleDelete:function(e){},handlePublish:function(e){this.showPulishDialog=!0,this.publish.id=e.id,this.publish.name=e.name},submitPublish:function(){var e=this;this.$store.dispatch("customerPublish",this.publish).then(function(){"success"==e.$store.state.user.customerPublish.status?(e.initTable(e.query),e.$notify.success({title:"操作成功",message:"客户 <"+e.publish.name+"> 发布成功"})):e.$notify.error({title:"操作失败",message:e.$store.state.user.customerPublish.error}),e.showPulishDialog=!1})},parseTimeStamp:function(e){var t=new Date(1e3*parseInt(e));return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},created:function(){var e=this;this.loadCascader(1).then(function(){e.loadCascader(20)}),this.regionValue(this.selectedOptions),this.$store.dispatch("brandList"),this.initTable(this.query)},computed:{regions:function(){return this.$store.state.user.region},brandList:function(){return this.$store.state.user.brandList},tableData:function(){return this.$store.state.user.customerManagerList.data},pageTotal:function(){return this.$store.state.user.customerManagerList.total}},watch:{}},i={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"wapper"},[l("div",{staticClass:"content-box"},[l("div",{staticClass:"tool"},[l("el-button",{attrs:{type:"success",icon:"el-icon-plus"},nativeOn:{click:function(t){return e.openDialog(t)}}},[e._v("添加客户")])],1),e._v(" "),l("div",{staticClass:"search"},[l("el-form",{staticClass:"demo-form-inline",attrs:{model:e.query}},[l("el-form-item",{attrs:{label:"发布状态"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.query.isPublic,callback:function(t){e.$set(e.query,"isPublic",t)},expression:"query.isPublic"}},e._l(e.isPublicOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"验收状态"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.query.received,callback:function(t){e.$set(e.query,"received",t)},expression:"query.received"}},e._l(e.receivedOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"领取人　"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.query.user,callback:function(t){e.$set(e.query,"user",t)},expression:"query.user"}},e._l(e.users,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"添加日期"}},[l("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.query.date,callback:function(t){e.$set(e.query,"date",t)},expression:"query.date"}})],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:e.searching},on:{click:e.onSearch}},[e._v("立即查询")])],1)],1)],1),e._v(" "),l("div",{staticClass:"table-tool"},[l("el-popover",{attrs:{placement:"right",width:"400",trigger:"click"}},[[l("div",[l("el-checkbox",{model:{value:e.tableColumn.id,callback:function(t){e.$set(e.tableColumn,"id",t)},expression:"tableColumn.id"}},[e._v("序号")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.name,callback:function(t){e.$set(e.tableColumn,"name",t)},expression:"tableColumn.name"}},[e._v("客户名称")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.phone,callback:function(t){e.$set(e.tableColumn,"phone",t)},expression:"tableColumn.phone"}},[e._v("联系方式")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.wechat,callback:function(t){e.$set(e.tableColumn,"wechat",t)},expression:"tableColumn.wechat"}},[e._v("微信")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.qq,callback:function(t){e.$set(e.tableColumn,"qq",t)},expression:"tableColumn.qq"}},[e._v("QQ")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.brand_name,callback:function(t){e.$set(e.tableColumn,"brand_name",t)},expression:"tableColumn.brand_name"}},[e._v("咨询品牌")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.province,callback:function(t){e.$set(e.tableColumn,"province",t)},expression:"tableColumn.province"}},[e._v("地区")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.project_name,callback:function(t){e.$set(e.tableColumn,"project_name",t)},expression:"tableColumn.project_name"}},[e._v("项目名称")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.description,callback:function(t){e.$set(e.tableColumn,"description",t)},expression:"tableColumn.description"}},[e._v("备注")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.publish,callback:function(t){e.$set(e.tableColumn,"publish",t)},expression:"tableColumn.publish"}},[e._v("状态")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.user,callback:function(t){e.$set(e.tableColumn,"user",t)},expression:"tableColumn.user"}},[e._v("领取人")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.accept,callback:function(t){e.$set(e.tableColumn,"accept",t)},expression:"tableColumn.accept"}},[e._v("验收")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.created,callback:function(t){e.$set(e.tableColumn,"created",t)},expression:"tableColumn.created"}},[e._v("创建日期")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.receive_date,callback:function(t){e.$set(e.tableColumn,"receive_date",t)},expression:"tableColumn.receive_date"}},[e._v("领取日期")])],1),e._v(" "),l("div",[l("el-checkbox",{model:{value:e.tableColumn.accept_date,callback:function(t){e.$set(e.tableColumn,"accept_date",t)},expression:"tableColumn.accept_date"}},[e._v("验收日期")])],1)],e._v(" "),l("el-button",{attrs:{slot:"reference",icon:""},slot:"reference"},[e._v("显示/隐藏列")])],2)],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{"max-width":"100%"},attrs:{data:e.tableData,"max-height":"350"}},[e.tableColumn.id?l("el-table-column",{attrs:{prop:"id",width:"50",label:"序号"}}):e._e(),e._v(" "),e.tableColumn.name?l("el-table-column",{attrs:{prop:"name",width:"180",label:"客户名称"}}):e._e(),e._v(" "),e.tableColumn.phone?l("el-table-column",{attrs:{prop:"phone",width:"120",label:"联系方式"}}):e._e(),e._v(" "),e.tableColumn.wechat?l("el-table-column",{attrs:{prop:"wechat",width:"120",label:"微信"}}):e._e(),e._v(" "),e.tableColumn.qq?l("el-table-column",{attrs:{prop:"qq",width:"120",label:"QQ"}}):e._e(),e._v(" "),e.tableColumn.brand_name?l("el-table-column",{attrs:{prop:"brand_name",label:"咨询品牌"}}):e._e(),e._v(" "),e.tableColumn.province?l("el-table-column",{attrs:{prop:"province",width:"200",label:"地区"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.province?l("span",[e._v(e._s(t.row.province.region_name)+" ")]):e._e(),e._v(" "),null!=t.row.city?l("span",[e._v(e._s(t.row.city.region_name))]):e._e(),e._v(" "),null!=t.row.area?l("span",[e._v(e._s(t.row.area.region_name))]):e._e()]}}],null,!1,2733780571)}):e._e(),e._v(" "),e.tableColumn.project_name?l("el-table-column",{attrs:{prop:"project_name",label:"项目名称"}}):e._e(),e._v(" "),e.tableColumn.publish?l("el-table-column",{attrs:{prop:"publish",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-tag",{attrs:{type:"0"==t.row.publish?"primary":"success","disable-transitions":""}},[e._v(e._s("0"==t.row.publish?"未发布":"已发布"))])]}}],null,!1,190459404)}):e._e(),e._v(" "),e.tableColumn.user?l("el-table-column",{attrs:{prop:"user",label:"领取人"}}):e._e(),e._v(" "),e.tableColumn.accept?l("el-table-column",{attrs:{prop:"accept",label:"验收"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-tag",{attrs:{type:"0"==t.row.accept?"primary":"danger","disable-transitions":""}},[e._v(e._s("0"==t.row.accept?"未验收":"已验收"))])]}}],null,!1,1137205364)}):e._e(),e._v(" "),e.tableColumn.created?l("el-table-column",{attrs:{prop:"created",width:"180",label:"创建日期"}}):e._e(),e._v(" "),e.tableColumn.receive_date?l("el-table-column",{attrs:{prop:"receive_date",width:"180",label:"领取日期"}}):e._e(),e._v(" "),e.tableColumn.accept_date?l("el-table-column",{attrs:{prop:"accept_date",width:"180",label:"验收日期"}}):e._e(),e._v(" "),e.tableColumn.description?l("el-table-column",{attrs:{prop:"description",label:"备注",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!=t.row.description?l("el-popover",{attrs:{placement:"left",title:"备注",width:"150",trigger:"hover",content:t.row.description}},[l("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(t.row.description.substring(0,15)+"..."))])],1):e._e()]}}],null,!1,1969554295)}):e._e(),e._v(" "),l("el-table-column",{attrs:{prop:"",width:"220",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:null==t.row.user?"编辑":"被领取的客户不允许再次编辑",placement:"top"}},[l("el-button",{attrs:{size:"mini",type:"primary",disabled:null!=t.row.user},on:{click:function(l){return e.handleEdit(t.row)}}},[l("i",{staticClass:"el-icon-edit-outline"})])],1),e._v(" "),l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"发布",placement:"top"}},[l("el-button",{attrs:{size:"mini",type:"success",disabled:1===t.row.publish},on:{click:function(l){return e.handlePublish(t.row)}}},[l("i",{staticClass:"iconfont icon-fabu1",staticStyle:{"font-size":"12px"}})])],1),e._v(" "),l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[l("el-button",{attrs:{size:"mini",type:"danger",disabled:null!=t.row.user||0!=t.row.publish},on:{click:function(l){return e.handleDelete(t.row)}}},[l("i",{staticClass:"el-icon-delete"})])],1)]}}])})],1),e._v(" "),l("div",{staticClass:"pageNation"},[l("el-pagination",{attrs:{"current-page":e.pageNow,"page-sizes":e.pageSizes,"page-size":e.pageSize,background:"",layout:"total, sizes, prev, pager, next",total:e.pageTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"添加客户",visible:e.showDialog,center:""},on:{"update:visible":function(t){e.showDialog=t},close:e.DialogClose}},[l("el-form",{ref:"form",staticClass:"el-form",attrs:{"status-icon":"",model:e.form,rules:e.rules,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"客户名称",prop:"name"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"联系方式",prop:"phone"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone","string"==typeof t?t.trim():t)},expression:"form.phone"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"产品意向"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.demand,callback:function(t){e.$set(e.form,"demand","string"==typeof t?t.trim():t)},expression:"form.demand"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"微信号码"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.wechat,callback:function(t){e.$set(e.form,"wechat","string"==typeof t?t.trim():t)},expression:"form.wechat"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"QQ号码"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq","string"==typeof t?t.trim():t)},expression:"form.qq"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"咨询品牌"}},[l("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择品牌"},model:{value:e.form.brand_id,callback:function(t){e.$set(e.form,"brand_id","string"==typeof t?t.trim():t)},expression:"form.brand_id"}},e._l(e.brandList,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"所在地域"}},[l("el-cascader",{attrs:{options:e.regions,props:e.props,"change-on-select":""},on:{"active-item-change":e.handleItemChange,change:e.handleChange,blur:e.handleBlur},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"项目名称"}},[l("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.project_name,callback:function(t){e.$set(e.form,"project_name","string"==typeof t?t.trim():t)},expression:"form.project_name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"备注信息"}},[l("el-input",{attrs:{type:"textarea","auto-complete":"off"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description","string"==typeof t?t.trim():t)},expression:"form.description"}})],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提 交")]),e._v(" "),l("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重 置")])],1)],1)],1),e._v(" "),l("el-dialog",{staticClass:"publish-dialog",attrs:{title:"提示",visible:e.showPulishDialog,center:""},on:{"update:visible":function(t){e.showPulishDialog=t}}},[l("div",{staticClass:"publish-content"},[l("el-form",{attrs:{"label-width":"80px"}},[l("el-form-item",{attrs:{label:"客户名称"}},[e._v("\n\t\t\t\t   \t"+e._s(e.publish.name)+"\n\t\t\t\t")]),e._v(" "),l("el-form-item",{attrs:{label:"发布类型"}},[l("el-select",{attrs:{placeholder:"请选择发布类型"},model:{value:e.publish.type,callback:function(t){e.$set(e.publish,"type",t)},expression:"publish.type"}},e._l(e.publishOptions,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),l("div",{staticClass:"foot",staticStyle:{"text-align":"center"}},[l("el-button",{attrs:{type:"success"},on:{click:e.submitPublish}},[e._v("立即发布")])],1)],1)],1)])],1)},staticRenderFns:[]};var r=l("VU/8")(n,i,!1,function(e){l("S/IA")},"data-v-46e06516",null);t.default=r.exports},"S/IA":function(e,t){}});