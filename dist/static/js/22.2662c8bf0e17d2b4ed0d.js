webpackJsonp([22],{"43fI":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("mvHQ"),a=o.n(r),i={data:function(){return{formItemWidth:"120px",showAddDialog:!1,form:{id:"",name:"",module_id:""},rules:{name:[{required:!0,message:"请输入文章名称",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 6 个字符",trigger:"blur"}]},defaultForm:{},update:!1}},methods:{init:function(){this.loadTable(),this.defaultForm=JSON.parse(a()(this.form))},loadTable:function(){this.$store.dispatch("ArticleManagerCategory")},submit:function(){var t=this;this.$refs.form.validate(function(e){if(e){var o="ArticleCategoryPost";t.update&&(o="ArticleCategoryPut"),t.$store.dispatch(o,t.form).then(function(){var e=t.$store.state.user.ArticleCategoryPost;t.update&&(e=t.$store.state.user.ArticleCategoryPut),"success"==e.status?(t.loadTable(),t.$notify.success("操作成功"),t.showAddDialog=!1,t.update=!1,t.resetForm()):t.$notify.error("操作失败"+e.errmsg)})}})},handleEidt:function(t,e,o){this.showAddDialog=!0,this.update=!0,this.form.id=t,this.form.name=e,this.isAdmin&&(this.form.module_id=o)},handleDel:function(t){var e=this;this.$confirm("删除该分类，则本分类下的文章则会自动更新到默认分类下，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$store.dispatch("ArticleCategoryDelete",{id:t}).then(function(){var t=e.$store.state.user.ArticleCategoryDelete;console.log(t),"success"==t.status?(e.$notify.success("操作成功"),e.loadTable()):e.$notify.error("操作失败")})}).catch(function(){})},resetForm:function(){for(var t in this.defaultForm)this.form[t]=this.defaultForm[t];this.$refs.form.resetFields(),this.update=!1}},created:function(){this.init()},computed:{tableData:function(){return this.$store.state.user.ArticleManagerCategory},isAdmin:function(){return this.$store.state.user.userInfo.isadmin},ForumModule:function(){var t=[];return this.$store.state.user.ForumModule.forEach(function(e){e.id>0&&t.push({label:e.name,value:e.id})}),t},title:function(){return!0===this.update?"修改文章分类":"添加文章分类"}}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"table-wallper"},[o("h3",{staticClass:"title"},[t._v("管理内容分类")]),t._v(" "),o("div",{staticClass:"table"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"450",border:""}},[o("el-table-column",{attrs:{prop:"id",label:"序号",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"分类名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"user",label:"添加人"}}),t._v(" "),o("el-table-column",{attrs:{prop:"created",label:"添加时间"}}),t._v(" "),o("el-table-column",{attrs:{prop:"department",label:"部门名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"id",label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"success"},nativeOn:{click:function(o){return t.handleEidt(e.row.id,e.row.name,e.row.module_id)}}},[t._v("\n\t\t\t      \t\t\t编辑\n\t\t\t      \t\t")]),t._v(" "),o("el-button",{attrs:{type:"danger"},nativeOn:{click:function(o){return t.handleDel(e.row.id)}}},[t._v("\n                  删除\n                ")])]}}])})],1)],1),t._v(" "),o("div",{staticClass:"table-tool"},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showAddDialog=!0}}},[t._v("添加分类")])],1),t._v(" "),o("el-dialog",{attrs:{title:t.title,visible:t.showAddDialog},on:{"update:visible":function(e){t.showAddDialog=e},close:t.resetForm}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"分类名称","label-width":t.formItemWidth,prop:"name"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),t.isAdmin?o("el-form-item",{attrs:{label:"所属模块","label-width":t.formItemWidth}},[o("el-select",{model:{value:t.form.module_id,callback:function(e){t.$set(t.form,"module_id",e)},expression:"form.module_id"}},t._l(t.ForumModule,function(t,e){return o("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1):t._e()],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.showAddDialog=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=o("VU/8")(i,l,!1,function(t){o("6qmg")},"data-v-788d4f4e",null);e.default=s.exports},"6qmg":function(t,e){}});