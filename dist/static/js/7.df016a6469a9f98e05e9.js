webpackJsonp([7],{"0e9+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{BindVisible:!1,tableLoading:!1,formLabelWidth:"120px",BindForm:{id:"",name:"",key:"",module_id:"",enumberate_id:""},BindFormRules:{name:[{required:!0,trigger:"blur",message:"实体名称必须填写"}],key:[{required:!0,trigger:"blur",message:"实体名称必须填写"},{validator:this.onlyString}],module_id:[{required:!0,trigger:"blur",message:"必须选择功能模块"}],enumberate_id:[{required:!0,trigger:"blur",message:"必须选择枚举类型"}]},submiting:!1}},methods:{init:function(){var e=this;this.$store.dispatch("getFunctionTable").then(function(){e.permissionOption}),this.table()},table:function(){var e=this;this.tableLoading=!0,this.$store.dispatch("getBindAttrList").then(function(){e.tableLoading=!1})},ShowBindVisible:function(){this.BindVisible=!0},BindOpen:function(){},BindClose:function(){this.reset("BindForm"),this.update=!1,this.BindVisible=!1},BindUpdate:function(e){for(var t in this.update=!0,e)this.BindForm[t]=e[t];this.BindVisible=!0,console.log(this.BindForm)},submitForm:function(){var e=this;this.$refs.BindForm.validate(function(t){if(t){e.submiting=!0;var n="AddBindAttr";e.update&&(n="UpdateBindAttr"),e.$store.dispatch(n,e.BindForm).then(function(){var t=e.$store.state.user.AddBindAttr;e.submiting=!1,"success"==t.status?(e.$notify.success("操作成功"),e.table(),e.BindVisible=!1,e.reset("BindForm")):e.$notify.error("操作失败"+t.errmsg)})}})},onlyString:function(e,t,n){/^[a-zA-Z\_]+$/.test(t)?n():n(new Error("字段名只能是字母和下划线"))},reset:function(e){for(var t in this.$refs[e].resetFields(),this.BindForm)this.BindForm[t]=""}},created:function(){this.init()},computed:{permissionOption:function(){var e=this.$store.state.user.functionTableData,t=[],n=0;return e.forEach(function(e,i){var r={};"group"==e.node_type&&(r.id=e.id,r.label=e.name,r.options=[],t.push(r),++n)}),e.forEach(function(e,n){for(var i in t)e.pid==t[i].id&&"node"==e.node_type&&t[i].options.push({label:e.name,value:e.id})}),t[n]={label:"其他",options:[]},e.forEach(function(e){null!=e.front_path&&0==e.pid&&t[n].options.push({label:e.name,value:e.id})}),t.forEach(function(e,n){e.options.length<1&&t.splice(n,1)}),t},EnumList:function(){var e=[];return this.$store.state.user.Enumberate.forEach(function(t){var n={};n.value=t.id,n.label=t.name,e.push(n)}),e},tableData:function(){return this.$store.state.user.BindAttrList}}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bind-wapper"},[n("div",{staticClass:"bind-tool"},[n("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return e.ShowBindVisible(t)}}},[e._v("增加绑定")])],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"bindattr-table",attrs:{data:e.tableData,border:""}},[n("el-table-column",{attrs:{prop:"id",label:"序号"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"实体名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"key",label:"属性标识"}}),e._v(" "),n("el-table-column",{attrs:{prop:"module_name",label:"功能模块"}}),e._v(" "),n("el-table-column",{attrs:{prop:"enumberate_name",label:"枚举名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"id",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(n){return e.BindUpdate(t.row)}}},[e._v("更换")])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:"属性绑定",visible:e.BindVisible,"before-close":e.BindClose,width:"30%"},on:{"update:visible":function(t){e.BindVisible=t},open:e.BindOpen}},[n("p",{staticStyle:{"font-size":"12px",color:"red","text-align":"center",margin:"0px"}},[e._v("当前版本暂只支持枚举类型的绑定")]),e._v(" "),n("el-form",{ref:"BindForm",attrs:{model:e.BindForm,rules:e.BindFormRules}},[n("el-form-item",{attrs:{prop:"name",label:"实体名称","label-width":e.formLabelWidth}},[n("el-input",{model:{value:e.BindForm.name,callback:function(t){e.$set(e.BindForm,"name","string"==typeof t?t.trim():t)},expression:"BindForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"key",label:"属性标识","label-width":e.formLabelWidth}},[n("el-input",{model:{value:e.BindForm.key,callback:function(t){e.$set(e.BindForm,"key","string"==typeof t?t.trim():t)},expression:"BindForm.key"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"module_id",label:"功能模块","label-width":e.formLabelWidth}},[n("el-select",{model:{value:e.BindForm.module_id,callback:function(t){e.$set(e.BindForm,"module_id",t)},expression:"BindForm.module_id"}},e._l(e.permissionOption,function(t,i){return n("el-option-group",{key:i,attrs:{label:t.label,value:t.value}},e._l(t.options,function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)}),1)],1),e._v(" "),n("el-form-item",{attrs:{prop:"enumberate_id",label:"枚举名称","label-width":e.formLabelWidth}},[n("el-select",{model:{value:e.BindForm.enumberate_id,callback:function(t){e.$set(e.BindForm,"enumberate_id",t)},expression:"BindForm.enumberate_id"}},e._l(e.EnumList,function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.BindVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary",loading:e.submiting},on:{click:e.submitForm}},[e._v("提 交")])],1)],1)],1)},staticRenderFns:[]};var a=n("VU/8")(i,r,!1,function(e){n("l0nR")},"data-v-48545276",null).exports,o=n("mvHQ"),s=n.n(o),l={data:function(){return{update:!1,rowIndex:0,EnumVisible:!1,formLabelWidth:"120px",form:{id:"",name:""},FormRules:{name:[{required:!0,trigger:"blur",message:"枚举类型不能为空"}]},defaultFormData:{name:"",value:"",index:"",disable:0},EnumForm:[],ItemKey:[],defaultIndex:0,CurrentKey:"",CurrentParentRow:{id:"",name:""},showErrmsg:!1}},methods:{init:function(){this.GetEnumberate()},handleCurrentChange:function(e){var t=this;this.EnuList.forEach(function(n,i){n.id==e.id&&(t.CurrentParentRow=n,t.defaultIndex=i)})},AddRow:function(){var e=JSON.parse(s()(this.defaultFormData)),t=this.buildKey();e.rowKey=t,this.EnumForm.push(e),this.ItemKey.push(t)},buildKey:function(){for(var e="",t="qwertyuioplkjhgfdsazxcvbnm",n=0;n<10;++n){e+=t[Math.floor(Math.random()*t.length+Math.random())]}return e},indexMethod:function(e){return e},EnumOpen:function(){this.showErrmsg=!1},EnumClose:function(){this.EnumForm=[],this.EnumVisible=!1,this.update=!1},EnumCurrentChange:function(e){console.log(e),this.CurrentKey=e.rowKey},RowRemove:function(){var e=this;""!=this.CurrentKey?this.EnumForm.forEach(function(t,n){t.rowKey==e.CurrentKey&&(e.EnumForm.splice(n,1),e.CurrentKey="")}):this.EnumForm.pop()},EnumAdd:function(){this.AddRow(),this.EnumVisible=!0},EnumModify:function(){var e=this,t=[];this.form.name=this.CurrentParentRow.name,this.form.id=this.CurrentParentRow.id,this.EnumVisible=!0,this.update=!0,this.CurrentParentRow.item.forEach(function(n){var i={};i.id=n.id,i.name=n.label,i.value=n.value,i.index=n.index,i.disable=Boolean(n.disable),i.rowKey=e.buildKey(),t.push(i)}),this.EnumForm=t},submitForm:function(){var e=this;if(this.showErrmsg=!1,this.EnumForm.forEach(function(t){""==t.name&&(e.showErrmsg=!0)}),this.showErrmsg)return!1;this.$refs.EnumForm.validate(function(t){if(t){var n="AddEnumberate";e.update&&(n="UpdateEnumberate"),e.$store.dispatch(n,{name:e.form.name,id:e.form.id,item:e.EnumForm}).then(function(){var t=e.$store.state.user.AddEnumberate;"success"==t.status?(e.$notify.success("操作成功"),e.GetEnumberate(),e.EnumVisible=!1):e.$notify.error("操作失败:"+t.errmsg)})}})},GetEnumberate:function(){this.$store.dispatch("GetEnumberate")}},created:function(){this.init()},computed:{EnuList:function(){var e=this.$store.state.user.Enumberate;return e.length>0&&(this.CurrentParentRow=e[0]),e},EnuListItem:function(){if(this.EnuList.length>0)return this.EnuList[this.defaultIndex].item}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"enumberate-wapper"},[n("div",{staticClass:"e-tool"},[n("el-button",{attrs:{type:"success"},nativeOn:{click:function(t){return e.EnumAdd(t)}}},[e._v("添加枚举")]),e._v(" "),n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.EnumModify(t)}}},[e._v("编辑")])],1),e._v(" "),n("div",{staticClass:"card"},[n("div",{staticClass:"card-item left"},[n("el-table",{staticClass:"enumberate-table",attrs:{data:e.EnuList,border:"",height:"320","highlight-current-row":""},on:{"row-click":e.handleCurrentChange}},[n("el-table-column",{attrs:{prop:"name",label:"枚举类型名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{class:{active:e.rowIndex==t.row.index},staticStyle:{cursor:"pointer"}},[e._v(e._s(t.row.name))])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"card-item right"},[n("el-table",{staticClass:"enumberate-table",attrs:{data:e.EnuListItem,border:"",height:"320"}},[n("el-table-column",{attrs:{prop:"label",label:"枚举项名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"value",label:"枚举项值"}}),e._v(" "),n("el-table-column",{attrs:{prop:"index",label:"序号"}}),e._v(" "),n("el-table-column",{attrs:{prop:"disable",label:"是否禁用"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.disable?n("span",[e._v("否")]):e._e(),e._v(" "),1==t.row.disable?n("span",[e._v("是")]):e._e()]}}])})],1)],1)]),e._v(" "),n("el-dialog",{attrs:{title:"枚举类型",visible:e.EnumVisible,"before-close":e.EnumClose,width:"30%"},on:{"update:visible":function(t){e.EnumVisible=t},open:e.EnumOpen}},[n("el-button",{attrs:{type:"success",size:"mini"},nativeOn:{click:function(t){return e.AddRow(t)}}},[e._v("新增行")]),n("el-button",{attrs:{type:"danger",size:"mini"},nativeOn:{click:function(t){return e.RowRemove(t)}}},[e._v("删除行")]),e._v(" "),n("el-form",{ref:"EnumForm",staticClass:"enum-form",attrs:{model:e.form,rules:e.FormRules}},[n("el-form-item",{attrs:{label:"枚举类型名称",prop:"name","label-width":e.formLabelWidth}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1)],1),e._v(" "),n("el-table",{staticClass:"enumberate-table",attrs:{border:"",data:e.EnumForm,"highlight-current-row":""},on:{"row-click":e.EnumCurrentChange}},[e._e(),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"枚举项名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{model:{value:e.EnumForm[t.$index].name,callback:function(n){e.$set(e.EnumForm[t.$index],"name",n)},expression:"EnumForm[scope.$index].name"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"value",label:"枚举项值"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{model:{value:e.EnumForm[t.$index].value,callback:function(n){e.$set(e.EnumForm[t.$index],"value",n)},expression:"EnumForm[scope.$index].value"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"index",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-input",{model:{value:e.EnumForm[t.$index].index,callback:function(n){e.$set(e.EnumForm[t.$index],"index",n)},expression:"EnumForm[scope.$index].index"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"disable",label:"是否禁用"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-checkbox",{model:{value:e.EnumForm[t.$index].disable,callback:function(n){e.$set(e.EnumForm[t.$index],"disable",n)},expression:"EnumForm[scope.$index].disable"}},[e._v("禁用")])]}}])})],1),e._v(" "),e.showErrmsg?n("p",{staticStyle:{"font-size":"12px",color:"red","text-align":"center","margin-bottom":"0px"}},[e._v("枚举项名称不能为空!")]):e._e(),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.EnumVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提 交")])],1)],1)],1)},staticRenderFns:[]};var d={data:function(){return{form:{name:"",type:""},FormRules:{}}},methods:{},components:{"v-bind":a,"v-enumberate":n("VU/8")(l,u,!1,function(e){n("cYDG")},"data-v-1f334e4e",null).exports}},m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"manager-wapper"},[t("el-tabs",{staticStyle:{height:"600px",position:"relative"},attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"枚举列表"}},[t("v-enumberate")],1),this._v(" "),t("el-tab-pane",{attrs:{label:"属性绑定"}},[t("v-bind")],1)],1)],1)},staticRenderFns:[]};var c=n("VU/8")(d,m,!1,function(e){n("fPRe")},"data-v-0371aaa8",null);t.default=c.exports},cYDG:function(e,t){},fPRe:function(e,t){},l0nR:function(e,t){}});