webpackJsonp([23],{"3J8d":function(t,e){},BuHD:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("woOf"),s=o.n(n),i={data:function(){return{dialogFunction:!1,dialogCssFile:!1,funcForm:{id:"",name:"",front_path:"",backend_path:"",description:"",pid:0,node_type:"node",classname:"",mobile_name:"",mobile_path:"",mobile_classname:"",show_pc:!0,show_mobile:!0,component_pc:[],component_mobile:[],update:0,pc_sort:0,mobile_sort:0},sourceFormData:[],dialogTitle:"",cssForm:{name:"",value:"",description:""},funcFormRules:{name:[{required:!0,message:"请输入功能名称",trigger:"blur"}],mobile_name:[{required:!0,message:"请输入功能名称",trigger:"blur"}],pid:[{required:!0,message:"请选择功能组",trigger:"blur"}]},cssFormRules:{value:[{required:!0,trigger:"blur",message:"图标文件地址不能为空"}]},selectedOptions:[],page:{now:1,size:10},loading:!0}},methods:{filterTag:function(t,e){return e.tag===t},openFuncDialog:function(){this.dialogTitle="添加功能",this.funcForm.node_type="node",this.dialogFunction=!0},openGroupDialog:function(){this.dialogTitle="添加组",this.funcForm.node_type="group",this.dialogFunction=!0},submitFuncForm:function(t){var e=this;this.$refs[t].validate(function(t){var o="addGroup",n=new FormData,s=e.funcForm;for(var i in s.show_pc=Number(s.show_pc),s.show_mobile=Number(s.show_mobile),s)n.append(i,s[i]);s.id>0&&s.update>0&&(o="updatePermission"),e.$store.dispatch(o,n).then(function(){"success"==e.$store.state.user.add_group.status?(e.$notify.success({title:"操作成功"}),e.resetForm(),e.loadTable()):e.$notify.error({title:"操作失败",message:e.$store.state.user.add_group.error}),e.dialogFunction=!1})})},handleChange:function(t){this.funcForm.pid=t[t.length-1]},loadTable:function(){var t=this;this.loading=!0,this.$store.dispatch("getFunctionTable",this.page).then(function(){t.loading=!1})},handleUpdateFunc:function(t){for(var e in t)for(var o in this.funcForm)o==e&&(this.funcForm[o]=t[e]);this.funcForm.show_pc=Boolean(this.funcForm.show_pc),this.funcForm.show_mobile=Boolean(this.funcForm.show_mobile),this.funcForm.update=1,this.dialogTitle="更新",this.dialogFunction=!0},closeDialogFunc:function(){this.funcForm.update=0,this.resetForm()},handleUpdateIconFile:function(){var t=this.$store.state.user.iconUrl;for(var e in t)this.cssForm[e]=t[e];this.dialogCssFile=!0},submitCssForm:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.$store.dispatch("updateIconCssFile",e.cssForm).then(function(){"success"==e.$store.state.user.updateIconCssFile.status?(e.$notify.success({title:"操作成功",message:"文件更新完毕"}),e.dialogCssFile=!1):e.$notify.error({title:"操作失败",message:"文件更新不成功"})})})},loadIconUrl:function(){this.$store.dispatch("loadIconUrl")},chooseFile:function(t){this.$refs[t].click()},handleComponent:function(t){this.$refs[t].files.length>0&&(this.funcForm[t]=this.$refs[t].files[0])},resetForm:function(){for(var t in this.sourceFormData)this.funcForm[t]=this.sourceFormData[t]},handleDeleteFunc:function(t){var e=this;this.$confirm("此操作将删除该 <"+t.name+">, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$store.dispatch("DeletePermission",{id:t.id}).then(function(){var t=e.$store.state.user.DeletePermission;"success"==t.status?(e.$notify.success({title:"操作成功"}),e.loadTable()):e.$notify.error({title:"操作失败",message:t.msg})})}).catch(function(){})}},created:function(){this.sourceFormData=s()({},this.funcForm),this.$store.dispatch("getGroups"),this.loadTable()},computed:{groupOptions:function(){var t=[{value:0,label:"全局"}],e=this.$store.state.user.groups;if(e.length>0)for(var o in e)t.push(e[o]);return t},tableData:function(){return this.$store.state.user.functionTableData}}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"permisstion-wapper"},[o("div",{staticClass:"table-wapper"},[o("div",{staticClass:"per-tool"},[o("el-button",{attrs:{type:"success",icon:"el-icon-plus"},nativeOn:{click:function(e){return t.openFuncDialog(e)}}},[t._v("添加功能")]),t._v(" "),o("el-button",{attrs:{type:"warning",icon:"el-icon-plus"},nativeOn:{click:function(e){return t.openGroupDialog(e)}}},[t._v("添加组")]),t._v(" "),o("el-button",{attrs:{type:"primary",icon:"el-icon-star-off"},nativeOn:{click:function(e){return t.handleUpdateIconFile(e)}}},[t._v("图标文件设置")])],1),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","min-height":"300px"},attrs:{data:t.tableData,"max-height":"550"}},[o("el-table-column",{attrs:{prop:"id",fixed:"",label:"序号"}}),t._v(" "),o("el-table-column",{attrs:{prop:"name",fixed:"",label:"功能名称",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t      \t"+t._s("node"===e.row.node_type&&e.row.pid>0?"　　　 |-"+e.row.name:e.row.name)+"\n\t\t      ")]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"mobile_name",label:"移动端名称",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{type:"danger","disable-transitions":""}},[t._v("\n\t\t          \t\t"+t._s(e.row.mobile_name)+"\n\t\t      \t\t")])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"show_pc",label:"PC端状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{type:0==e.row.show_pc?"warning":"success","disable-transitions":""}},[t._v(t._s(0==e.row.show_pc?"隐藏":"显示"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"show_mobile",label:"移动状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{type:0==e.row.show_mobile?"warning":"success","disable-transitions":""}},[t._v(t._s(0==e.row.show_mobile?"隐藏":"显示"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"pc_sort",label:"PC排序"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{type:"node"===e.row.node_type?"primary":"success","disable-transitions":""}},[t._v(t._s(e.row.pc_sort))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"mobile_sort",label:"移动排序"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{type:"node"===e.row.node_type?"primary":"success","disable-transitions":""}},[t._v(t._s(e.row.mobile_sort))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"classname",label:"图标类名",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{prop:"mobile_classname",label:"移动端图标类名",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{prop:"node_type",label:"功能类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",{attrs:{type:"node"===e.row.node_type?"primary":"success","disable-transitions":""}},[t._v(t._s("node"==e.row.node_type?"功能节点":"功能组"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"parentNode",label:"所属功能组",width:"100"}}),t._v(" "),o("el-table-column",{attrs:{prop:"front_path",width:"150",label:"前端路由"}}),t._v(" "),o("el-table-column",{attrs:{prop:"mobile_path",width:"150",label:"移动端路由"}}),t._v(" "),o("el-table-column",{attrs:{prop:"backend_path",width:"250",label:"控制器"}}),t._v(" "),o("el-table-column",{attrs:{prop:"template_pc_name",width:"150",label:"PC端组件"}}),t._v(" "),o("el-table-column",{attrs:{prop:"template_mobile_name",width:"150",label:"移动端组件"}}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return["node"===e.row.node_type?o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑功能",placement:"top"}},[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(o){return t.handleUpdateFunc(e.row)}}},[o("i",{staticClass:"el-icon-edit-outline"})])],1):o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑组",placement:"top"}},[o("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(o){return t.handleUpdateFunc(e.row)}}},[o("i",{staticClass:"el-icon-edit-outline"})])],1),t._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[o("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(o){return t.handleDeleteFunc(e.row)}}})],1)]}}])})],1)],1),t._v(" "),o("div",{staticClass:"dialog-wapper"},[o("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogFunction,center:""},on:{"update:visible":function(e){t.dialogFunction=e},close:t.closeDialogFunc}},[o("el-form",{ref:"funcForm",staticClass:"demo-funcForm",style:{"max-width":"600px","box-sizing":"border-box"},attrs:{model:t.funcForm,inline:!0,rules:t.funcFormRules,"label-width":"100px"}},[o("el-form-item",{style:{"text-align":"left"},attrs:{label:"功能组",prop:"pid"}},[o("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.funcForm.pid,callback:function(e){t.$set(t.funcForm,"pid","string"==typeof e?e.trim():e)},expression:"funcForm.pid"}},t._l(t.groupOptions,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),o("el-form-item",{attrs:{label:"功能名称",prop:"name"}},[o("el-input",{model:{value:t.funcForm.name,callback:function(e){t.$set(t.funcForm,"name","string"==typeof e?e.trim():e)},expression:"funcForm.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"移动端名称",prop:"mobile_name"}},[o("el-input",{model:{value:t.funcForm.mobile_name,callback:function(e){t.$set(t.funcForm,"mobile_name","string"==typeof e?e.trim():e)},expression:"funcForm.mobile_name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"前端路由",prop:"front_path"}},[o("el-input",{model:{value:t.funcForm.front_path,callback:function(e){t.$set(t.funcForm,"front_path","string"==typeof e?e.trim():e)},expression:"funcForm.front_path"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"移动端路由"}},[o("el-input",{model:{value:t.funcForm.mobile_path,callback:function(e){t.$set(t.funcForm,"mobile_path","string"==typeof e?e.trim():e)},expression:"funcForm.mobile_path"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"控制器",prop:"backend_path"}},[o("el-input",{attrs:{placeholder:"多个控制器请用 | 隔开"},model:{value:t.funcForm.backend_path,callback:function(e){t.$set(t.funcForm,"backend_path","string"==typeof e?e.trim():e)},expression:"funcForm.backend_path"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"图标类",prop:"classname"}},[o("el-input",{model:{value:t.funcForm.classname,callback:function(e){t.$set(t.funcForm,"classname","string"==typeof e?e.trim():e)},expression:"funcForm.classname"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"移动端图标类",prop:"classname"}},[o("el-input",{model:{value:t.funcForm.mobile_classname,callback:function(e){t.$set(t.funcForm,"mobile_classname","string"==typeof e?e.trim():e)},expression:"funcForm.mobile_classname"}})],1),t._v(" "),o("br"),t._v(" "),o("el-form-item",{attrs:{label:"PC端显示"}},[o("el-switch",{attrs:{"active-color":"#13ce66","active-text":"显示","inactive-text":"关闭"},model:{value:t.funcForm.show_pc,callback:function(e){t.$set(t.funcForm,"show_pc",e)},expression:"funcForm.show_pc"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"移动端显示"}},[o("el-switch",{attrs:{"active-color":"#13ce66","active-text":"显示","inactive-text":"关闭"},model:{value:t.funcForm.show_mobile,callback:function(e){t.$set(t.funcForm,"show_mobile",e)},expression:"funcForm.show_mobile"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"PC端排序"}},[o("el-input",{model:{value:t.funcForm.pc_sort,callback:function(e){t.$set(t.funcForm,"pc_sort","string"==typeof e?e.trim():e)},expression:"funcForm.pc_sort"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"移动端排序"}},[o("el-input",{model:{value:t.funcForm.mobile_sort,callback:function(e){t.$set(t.funcForm,"mobile_sort","string"==typeof e?e.trim():e)},expression:"funcForm.mobile_sort"}})],1),t._v(" "),o("el-form-item",{staticStyle:{width:"100%",height:"35px"},attrs:{label:"PC组件"}},[o("div",{staticClass:"upload-file"},[o("el-button",{attrs:{type:"success"},nativeOn:{click:function(e){return t.chooseFile("component_pc")}}},[t._v("选择文件")]),t._v(" "),o("input",{ref:"component_pc",attrs:{type:"file",name:"component_pc"},on:{change:function(e){return t.handleComponent("component_pc")}}}),t._v(" "),o("span",{staticClass:"file-name"},[t._v("\n\t\t\t\t\t\t"+t._s(t.funcForm.component_pc.name)+"\n\t\t\t\t\t")])],1)]),t._v(" "),o("el-form-item",{attrs:{label:"移动端组件"}},[o("div",{staticClass:"upload-file"},[o("el-button",{attrs:{type:"success"},nativeOn:{click:function(e){return t.chooseFile("component_mobile")}}},[t._v("选择文件")]),t._v(" "),o("input",{ref:"component_mobile",attrs:{type:"file",name:"component_mobile"},on:{change:function(e){return t.handleComponent("component_mobile")}}}),t._v(" "),o("span",{staticClass:"file-name"},[t._v("\n\t\t\t\t\t\t"+t._s(t.funcForm.component_mobile.name)+"\n\t\t\t\t\t")])],1)])],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.submitFuncForm("funcForm")}}},[t._v("确 定")]),t._v(" "),o("el-button",{on:{click:function(e){t.dialogFunction=!1}}},[t._v("取 消")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"图标文件修改",visible:t.dialogCssFile,center:""},on:{"update:visible":function(e){t.dialogCssFile=e}}},[o("el-form",{ref:"cssForm",style:{"max-width":"600px","box-sizing":"border-box"},attrs:{model:t.cssForm,rules:t.cssFormRules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"文件地址",prop:"value"}},[o("el-input",{model:{value:t.cssForm.value,callback:function(e){t.$set(t.cssForm,"value","string"==typeof e?e.trim():e)},expression:"cssForm.value"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"描述"}},[o("el-input",{attrs:{type:"textarea"},model:{value:t.cssForm.description,callback:function(e){t.$set(t.cssForm,"description","string"==typeof e?e.trim():e)},expression:"cssForm.description"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.submitCssForm("cssForm")}}},[t._v("确 定")]),t._v(" "),o("el-button",{on:{click:function(e){t.dialogCssFile=!1}}},[t._v("取 消")])],1)],1)],1)])},staticRenderFns:[]};var a=o("VU/8")(i,l,!1,function(t){o("3J8d")},null,null);e.default=a.exports}});