webpackJsonp([14],{"158U":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("mvHQ"),r=o.n(a),s={data:function(){return{showAddDialog:!1,form:{id:"",name:"",index:0},rules:{name:[{required:!0,message:"请输入版块名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 6 个字符",trigger:"blur"}]},defaultForm:{},update:!1}},methods:{init:function(){this.loadTable(),this.defaultForm=JSON.parse(r()(this.form))},loadTable:function(){this.$store.dispatch("GetForumModuleTable")},submit:function(){var t=this;this.$refs.form.validate(function(e){if(e){var o="ForumModuleStore";t.update&&(o="ForumModuleUpdate"),t.$store.dispatch(o,t.form).then(function(){"success"==t.$store.state.user.ForumModuleStore.status?(t.loadTable(),t.$notify.success("保存成功"),t.showAddDialog=!1,t.updateModules(),t.update=!1,t.resetForm()):t.$notify.error("操作失败")})}})},handleEidt:function(t){this.showAddDialog=!0,this.update=!0,this.form.id=t.id,this.form.name=t.name,this.form.index=t.index},handleDel:function(t,e){var o=this;this.$confirm("删除模块<"+e+">, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.$store.dispatch("ForumModuleDel",{id:t}).then(function(){var t=o.$store.state.user.ForumModuleStore;"success"==t.status?(o.$notify.success("操作成功"),o.loadTable()):o.$notify.error("操作失败"+t.errmsg)})}).catch(function(){})},resetForm:function(){for(var t in this.defaultForm)this.form[t]=this.defaultForm[t];this.update=!1},updateModules:function(){var t=this;this.$store.dispatch("ForumModuleSync").then(function(){var e=t.$store.state.user.ForumModuleSync;"success"==e.status?(t.$notify.success("刷新成功"),t.loadTable()):t.$notify.error("操作失败"+e.errmsg)})}},created:function(){this.init()},computed:{tableData:function(){return this.$store.state.user.ForumModuleTableData},title:function(){return this.update?"修改版块":"添加版块"}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"table-wallper"},[o("div",{staticClass:"table-tool"},[o("p",[o("el-button",{attrs:{type:"success"},on:{click:function(e){t.showAddDialog=!0}}},[t._v("添加版块")]),t._v(" "),o("el-button",{attrs:{type:"success"},on:{click:t.updateModules}},[t._v("更新版块")])],1)]),t._v(" "),o("div",{staticClass:"table"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"450",border:""}},[o("el-table-column",{attrs:{prop:"index",label:"排序",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{prop:"name",label:"版块名称"}}),t._v(" "),t._e(),t._v(" "),o("el-table-column",{attrs:{prop:"attr",label:"属性"}}),t._v(" "),o("el-table-column",{attrs:{prop:"created",label:"添加时间"}}),t._v(" "),o("el-table-column",{attrs:{prop:"id",label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"success"},nativeOn:{click:function(o){return t.handleEidt(e.row)}}},[t._v("\n\t\t\t      \t\t\t编辑\n\t\t\t      \t\t")]),t._v(" "),o("el-button",{attrs:{type:"danger"},nativeOn:{click:function(o){return t.handleDel(e.row.id,e.row.name)}}},[t._v("\n                            删除\n                        ")])]}}])})],1)],1),t._v(" "),o("el-dialog",{attrs:{title:t.title,visible:t.showAddDialog},on:{"update:visible":function(e){t.showAddDialog=e},close:t.resetForm}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"版块名称","label-width":"120px",prop:"name"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"排序","label-width":"120px"}},[o("el-input",{model:{value:t.form.index,callback:function(e){t.$set(t.form,"index",e)},expression:"form.index"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.showAddDialog=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var l=o("VU/8")(s,n,!1,function(t){o("OlLI")},"data-v-a9f84e00",null);e.default=l.exports},OlLI:function(t,e){}});